<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title data-i18n-key="title">Smart Mall DApp</title>
  <style>
    /* --- CHUNG --- */
    body {
      background: #0a1a2f;
      color: #fff;
      font-family: Arial, sans-serif;
      margin: 0;
      padding-bottom: 80px;
    }
    section { display: none; padding: 20px; margin: 10px; background: #162447; border:2px solid #21e6c1; border-radius:8px; }
    section.show { display: block; }
    h2 { color: #21e6c1; margin-top: 0; }
    button,input,code { border:none; border-radius:4px; }
    button {
      background:#21e6c1;
      color:#0a1a2f;
      font-weight:bold;
      cursor:pointer;
      margin:6px 0;
      padding:8px;
      width:100%;
    }
    button.small { width:auto; padding:6px 12px; margin:4px 2px; }
    input {
      width:100%;
      padding:8px;
      margin:6px 0;
      background:#1f4068;
      color:#fff;
    }
    code {
      display:block;
      background:#1f4068;
      padding:8px;
      margin:8px 0;
      font-family:monospace;
    }

    /* --- MARQUEE ƒê·ªòNG TRANG CH·ª¶ --- */
    .marquee {
      overflow:hidden;
      white-space:nowrap;
      box-sizing:border-box;
      animation: marquee 12s linear infinite;
    }
    @keyframes marquee {
      0%   { transform: translateX(100%); }
      100% { transform: translateX(-100%); }
    }

    /* --- NAV --- */
    nav {
      position:fixed; bottom:0; left:0; right:0;
      display:flex; background:#162447; border-top:2px solid #21e6c1;
    }
    nav .nav-btn {
      flex:1; padding:8px 0; font-size:14px;
      color:#fff; background:#162447; cursor:pointer;
    }
    nav .nav-btn.active, nav .nav-btn:hover {
      background:#21e6c1; color:#162447;
    }
    /* --- LANGUAGE SELECT --- */
    #langSelect {
      position:fixed; top:10px; right:10px;
      background:#1f4068; color:#fff; padding:4px 8px;
    }

    /* --- DATE TABS --- */
    .date-tab-bar {
      display:flex; justify-content:space-between;
      background:#1b2c45; padding:6px; border-radius:8px; margin:12px 0;
    }
    .date-tab-bar button {
      flex:1; margin:0 2px; padding:6px 4px;
      background:#0f1c2e; color:#ccc; font-size:13px; cursor:pointer;
    }
    .date-tab-bar button.active {
      background:#21e6c1; color:#162447; font-weight:bold;
    }

    /* --- GRID --- */
    .grid {
      display:grid;
      grid-template-columns:repeat(auto-fill,minmax(140px,1fr));
      gap:10px;
    }
    .product, .sale-item, .nft-item {
      padding:10px; border-radius:6px; color:#fff;
    }

    /* --- MODAL --- */
    .modal {
      display:none; position:fixed; top:0; left:0; right:0; bottom:0;
      background:rgba(0,0,0,0.5);
      justify-content:center; align-items:center;
    }
    .modal.show { display:flex !important; }
    .modal-content {
      background:#fff; color:#000; padding:20px; border-radius:8px; width:300px;
    }

    /* --- TABLE --- */
    table { width:100%; border-collapse:collapse; margin-top:10px; }
    th,td {
      border:1px solid #21e6c1; padding:6px; font-size:14px;
    }
    th { background:#1b2c45; }

    /* --- POS / NEG --- */
    .pos { color:#4caf50; }
    .neg { color:#f44336; }
  </style>
</head>
<body>

  <!-- Language selector -->
  <select id="langSelect">
    <option value="vi">üáªüá≥ Vi·ªát</option>
    <option value="en">üá¨üáß English</option>
  </select>

  <!-- LOGIN -->
  <section id="login" class="show">
    <h2 data-i18n-key="login_title">üîë ƒêƒÉng nh·∫≠p</h2>
    <input id="usernameInput" data-i18n-key="login_input" placeholder="Nh·∫≠p username (vi·∫øt li·ªÅn)" />
    <button id="loginBtn" data-i18n-key="login_button">Ti·∫øp t·ª•c</button>
  </section>

  <!-- APP -->
  <div id="app" style="display:none">

    <!-- NAV -->
    <nav>
      <button id="btn-home"    class="nav-btn" onclick="showSection('home')"    data-i18n-key="nav_home">üè† Trang ch·ªß</button>
      <button id="btn-session" class="nav-btn" onclick="showSection('session')" data-i18n-key="nav_session">‚è±Ô∏è Phi√™n</button>
      <button id="btn-nft"     class="nav-btn" onclick="showSection('nft')"     data-i18n-key="nav_nft">üßæ NFT</button>
      <button id="btn-wallet"  class="nav-btn" onclick="showSection('wallet')"  data-i18n-key="nav_wallet">üí∞ V√≠</button>
      <button id="btn-profile" class="nav-btn" onclick="showSection('profile')" data-i18n-key="nav_profile">üë§ Th√¥ng tin</button>
    </nav>

    <!-- HOME -->
    <section id="home">
      <h2 data-i18n-key="home_title">üì¢ Th√¥ng b√°o t·ª´ Admin</h2>
      <div class="marquee">
        <span id="admin-notice" data-i18n-key="home_notice">
          Ch√†o m·ª´ng b·∫°n ƒë·∫øn v·ªõi Smart Mall ‚Äì Giao d·ªãch th√¥ng minh, c·ªông ƒë·ªìng b·ªÅn v·ªØng!
        </span>
      </div>
    </section>

    <!-- SESSION -->
    <section id="session">
      <h2 data-i18n-key="session_title">üïí Phi√™n giao d·ªãch</h2>
      <div class="date-tab-bar" id="sessionDateTabs"></div>
      <p><span data-i18n-key="session_selected">Ng√†y phi√™n ƒë√£ ch·ªçn:</span> <b id="selectedDateText"></b></p>

      <div id="registrationBox">
        <button onclick="showRegisterModal()" data-i18n-key="session_register_btn">
          ƒêƒÉng k√Ω phi√™n (20 000 SML)
        </button>
      </div>
      <div id="joinContainer" style="display:none">
        <button class="small" onclick="joinSession()" data-i18n-key="session_join_btn">
          Tham gia phi√™n
        </button>
      </div>

      <div id="products" style="display:none">
        <h3 data-i18n-key="session_products_today">S·∫£n ph·∫©m phi√™n h√¥m nay</h3>
        <div id="productList" class="grid"></div>
        <h3 data-i18n-key="session_pending_sales">S·∫£n ph·∫©m treo b√°n</h3>
        <div id="pendingSaleList" class="grid"></div>
      </div>
    </section>

    <!-- NFT -->
    <section id="nft">
      <h2 data-i18n-key="nft_title">üßæ NFT c·ªßa t√¥i</h2>
      <div id="nftList">Ch∆∞a c√≥ s·∫£n ph·∫©m.</div>
      <p>
        <span data-i18n-key="nft_total_spent">T·ªïng chi ti√™u:</span>
        <span id="totalSpent">0</span> USDT
      </p>
      <h3 data-i18n-key="nft_history_title">L·ªãch s·ª≠ NFT</h3>
      <ul id="nftHistory">Ch∆∞a c√≥ l·ªãch s·ª≠.</ul>
    </section>

    <!-- WALLET -->
    <section id="wallet">
      <h2 data-i18n-key="wallet_title">üí∞ V√≠ SML</h2>
      <p>
        <span data-i18n-key="wallet_balance">S·ªë d∆∞:</span>
        <span id="walletBalance">100 000</span> SML
      </p>
      <div class="wallet-tabs">
        <button onclick="showDeposit()"   data-i18n-key="wallet_deposit">N·∫°p</button>
        <button onclick="showTransfer()"  data-i18n-key="wallet_transfer">Chuy·ªÉn</button>
        <button onclick="showWithdraw()"  data-i18n-key="wallet_withdraw">R√∫t</button>
      </div>
      <div id="walletAction"></div>
      <h3 data-i18n-key="wallet_tx_history">L·ªãch s·ª≠ giao d·ªãch</h3>
      <div id="walletHistory">Ch∆∞a c√≥ giao d·ªãch.</div>
      <h3 data-i18n-key="wallet_req_history">L·ªãch s·ª≠ y√™u c·∫ßu n·∫°p/r√∫t</h3>
      <table>
        <thead>
          <tr>
            <th data-i18n-key="req_type">Lo·∫°i</th>
            <th data-i18n-key="req_sml">SML</th>
            <th data-i18n-key="req_usdt">USDT c·∫ßn</th>
            <th data-i18n-key="req_addr">ƒê·ªãa ch·ªâ</th>
            <th data-i18n-key="req_time">Th·ªùi gian</th>
            <th data-i18n-key="req_status">Tr·∫°ng th√°i</th>
          </tr>
        </thead>
        <tbody id="requestHistory"></tbody>
      </table>
    </section>

    <!-- PROFILE -->
    <section id="profile">
      <h2 data-i18n-key="profile_title">üë§ Th√¥ng tin c√° nh√¢n</h2>
      <p><span data-i18n-key="profile_username">Username:</span> <b id="profileUsername"></b></p>
      <input id="phone" placeholder="S·ªë ƒëi·ªán tho·∫°i"/>
      <input id="fullname" placeholder="H·ªç t√™n ƒë·∫ßy ƒë·ªß"/>
      <input id="bep20" placeholder="ƒê·ªãa ch·ªâ v√≠ BEP20"/>
      <button onclick="saveProfile()" data-i18n-key="profile_save">L∆∞u th√¥ng tin</button>
      <div id="referralSection">
        <h3 data-i18n-key="profile_referral">üîó Link gi·ªõi thi·ªáu</h3>
        <p><a href="#" id="referralLink" target="_blank"></a></p>
        <p><span data-i18n-key="profile_direct">Gi·ªõi thi·ªáu tr·ª±c ti·∫øp:</span> <span id="directRefCount">0</span></p>
        <p><span data-i18n-key="profile_team">ƒê·ªôi nh√≥m:</span> <span id="teamRefCount">0</span></p>
      </div>
    </section>

    <!-- MODALS -->
    <div class="modal" id="registerModal">
      <div class="modal-content">
        <h3 data-i18n-key="reg_modal_title">Ph√≠ ƒëƒÉng k√Ω: 20 000 SML</h3>
        <button onclick="confirmRegister()" data-i18n-key="reg_modal_confirm">X√°c nh·∫≠n</button>
        <button onclick="closeRegisterModal()" data-i18n-key="reg_modal_cancel">H·ªßy</button>
      </div>
    </div>

    <div class="modal" id="depositModal">
      <div class="modal-content">
        <h3 data-i18n-key="dep_modal_title">Chuy·ªÉn USDT BEP20 t·ªõi:</h3>
        <code id="depositAddress">0xYourBEP20AddressHere</code>
        <p>
          <span data-i18n-key="dep_usdt_price">Gi√° USDT:</span>
          <span id="usdtPrice">26 400</span> VND
        </p>
        <input type="number" id="depositSML" placeholder="S·ªë SML mu·ªën n·∫°p"/>
        <p id="requiredUSDT">C·∫ßn chuy·ªÉn: 0 USDT</p>
        <button onclick="submitDeposit()" data-i18n-key="dep_modal_confirm">X√°c nh·∫≠n n·∫°p</button>
        <button onclick="closeDepositModal()"  data-i18n-key="dep_modal_cancel">H·ªßy</button>
      </div>
    </div>

    <div class="modal" id="withdrawModal">
      <div class="modal-content">
        <h3 data-i18n-key="wd_modal_title">R√∫t SML (min 1 000 000)</h3>
        <input type="number" id="withdrawAmt" placeholder="S·ªë SML r√∫t"/>
        <button onclick="submitWithdraw()" data-i18n-key="wd_modal_confirm">X√°c nh·∫≠n r√∫t</button>
        <button onclick="closeWithdrawModal()" data-i18n-key="wd_modal_cancel">H·ªßy</button>
      </div>
    </div>

  </div>

  <script>
    // D·ªØ li·ªáu d·ªãch
    const locales = {
      vi: {
        title:             'Smart Mall DApp',
        login_title:       'üîë ƒêƒÉng nh·∫≠p',
        login_input:       'Nh·∫≠p username (vi·∫øt li·ªÅn)',
        login_button:      'Ti·∫øp t·ª•c',
        nav_home:          'üè† Trang ch·ªß',
        nav_session:       '‚è±Ô∏è Phi√™n',
        nav_nft:           'üßæ NFT',
        nav_wallet:        'üí∞ V√≠',
        nav_profile:       'üë§ Th√¥ng tin',
        home_title:        'üì¢ Th√¥ng b√°o t·ª´ Admin',
        home_notice:       'Ch√†o m·ª´ng b·∫°n ƒë·∫øn v·ªõi Smart Mall ‚Äì Giao d·ªãch th√¥ng minh, c·ªông ƒë·ªìng b·ªÅn v·ªØng!',
        session_title:     'üïí Phi√™n giao d·ªãch',
        session_selected:  'Ng√†y phi√™n ƒë√£ ch·ªçn:',
        session_register_btn: 'ƒêƒÉng k√Ω phi√™n (20 000 SML)',
        session_join_btn:  'Tham gia phi√™n',
        session_products_today: 'S·∫£n ph·∫©m phi√™n h√¥m nay',
        session_pending_sales:  'S·∫£n ph·∫©m treo b√°n',
        nft_title:         'üßæ NFT c·ªßa t√¥i',
        nft_total_spent:   'T·ªïng chi ti√™u:',
        nft_history_title: 'L·ªãch s·ª≠ NFT',
        wallet_title:      'üí∞ V√≠ SML',
        wallet_balance:    'S·ªë d∆∞:',
        wallet_deposit:    'N·∫°p',
        wallet_transfer:   'Chuy·ªÉn',
        wallet_withdraw:   'R√∫t',
        wallet_tx_history: 'L·ªãch s·ª≠ giao d·ªãch',
        wallet_req_history:'L·ªãch s·ª≠ y√™u c·∫ßu n·∫°p/r√∫t',
        req_type:          'Lo·∫°i',
        req_sml:           'SML',
        req_usdt:          'USDT c·∫ßn',
        req_addr:          'ƒê·ªãa ch·ªâ',
        req_time:          'Th·ªùi gian',
        req_status:        'Tr·∫°ng th√°i',
        profile_title:     'üë§ Th√¥ng tin c√° nh√¢n',
        profile_username:  'Username:',
        profile_save:      'L∆∞u th√¥ng tin',
        profile_referral:  'üîó Link gi·ªõi thi·ªáu',
        profile_direct:    'Gi·ªõi thi·ªáu tr·ª±c ti·∫øp:',
        profile_team:      'ƒê·ªôi nh√≥m:',
        reg_modal_title:   'Ph√≠ ƒëƒÉng k√Ω: 20 000 SML',
        reg_modal_confirm: 'X√°c nh·∫≠n',
        reg_modal_cancel:  'H·ªßy',
        dep_modal_title:   'Chuy·ªÉn USDT BEP20 t·ªõi:',
        dep_usdt_price:    'Gi√° USDT:',
        dep_modal_confirm: 'X√°c nh·∫≠n n·∫°p',
        dep_modal_cancel:  'H·ªßy',
        wd_modal_title:    'R√∫t SML (min 1 000 000)',
        wd_modal_confirm:  'X√°c nh·∫≠n r√∫t',
        wd_modal_cancel:   'H·ªßy'
      },
      en: {
        title:             'Smart Mall DApp',
        login_title:       'üîë Login',
        login_input:       'Enter username',
        login_button:      'Continue',
        nav_home:          'üè† Home',
        nav_session:       '‚è±Ô∏è Session',
        nav_nft:           'üßæ My NFTs',
        nav_wallet:        'üí∞ Wallet',
        nav_profile:       'üë§ Profile',
        home_title:        'üì¢ Announcements',
        home_notice:       'Welcome to Smart Mall ‚Äì Smart trading, strong community!',
        session_title:     'üïí Trading Session',
        session_selected:  'Selected date:',
        session_register_btn: 'Register (20 000 SML)',
        session_join_btn:  'Join session',
        session_products_today: 'Today‚Äôs products',
        session_pending_sales:  'Pending sales',
        nft_title:         'üßæ My NFTs',
        nft_total_spent:   'Total spent:',
        nft_history_title: 'NFT History',
        wallet_title:      'üí∞ Wallet',
        wallet_balance:    'Balance:',
        wallet_deposit:    'Deposit',
        wallet_transfer:   'Transfer',
        wallet_withdraw:   'Withdraw',
        wallet_tx_history: 'Transaction History',
        wallet_req_history:'Deposit/Withdraw Requests',
        req_type:          'Type',
        req_sml:           'SML',
        req_usdt:          'USDT needed',
        req_addr:          'Address',
        req_time:          'Time',
        req_status:        'Status',
        profile_title:     'üë§ Profile',
        profile_username:  'Username:',
        profile_save:      'Save',
        profile_referral:  'üîó Referral link',
        profile_direct:    'Direct referrals:',
        profile_team:      'Team:',
        reg_modal_title:   'Registration fee: 20 000 SML',
        reg_modal_confirm: 'Confirm',
        reg_modal_cancel:  'Cancel',
        dep_modal_title:   'Send USDT BEP20 to:',
        dep_usdt_price:    'USDT price:',
        dep_modal_confirm: 'Confirm deposit',
        dep_modal_cancel:  'Cancel',
        wd_modal_title:    'Withdraw SML (min 1 000 000)',
        wd_modal_confirm:  'Confirm withdraw',
        wd_modal_cancel:   'Cancel'
      }
    };

    // √Åp d·ª•ng ng√¥n ng·ªØ
    function applyLocale(lang) {
      document.querySelectorAll('[data-i18n-key]').forEach(el=>{
        const key = el.getAttribute('data-i18n-key');
        if (locales[lang][key] != null) {
          el.textContent = locales[lang][key];
        }
      });
      document.title = locales[lang].title;
    }
    document.getElementById('langSelect').addEventListener('change', e=>{
      applyLocale(e.target.value);
    });

    // Ph·∫ßn c√≤n l·∫°i c·ªßa script (ƒëƒÉng nh·∫≠p, session, s·∫£n ph·∫©m, nft, v√≠...) gi·ªØ nguy√™n
    // b·∫°n c√≥ th·ªÉ d√°n l·∫°i to√†n b·ªô JS t·ª´ b·∫£n tr∆∞·ªõc ƒë√¢y (initApp, renderProducts, buyProduct, v.v.)
    // ƒë·ªÉ ti·∫øt ki·ªám kh√¥ng gian, m√¨nh ch·ªâ minh h·ªça i18n v√† marquee ƒë·ªông ·ªü ƒë√¢y.

    // Khi kh·ªüi t·∫°o, √°p d·ª•ng locale m·∫∑c ƒë·ªãnh
    document.addEventListener('DOMContentLoaded', ()=>{
      applyLocale('vi');
      // ... g·ªçi initApp() sau khi handleLogin th√†nh c√¥ng
    });
  </script>
</body>
</html>
